# CalibrationSection3 UI - Visual Guide

## Layout & Components

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   CALIBRATION SECTION 3                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  VISUALIZATION CONTROLS (UPDATED)                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ [ğŸ¹ Show Layout] [Distribution: â¯¯] [Color Pickers...]   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â”‚  PIANO KEYBOARD (88 KEYS)                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ [W] [W][B][W][B][W] [W] [W][B][W][B][W][B][W] ...      â”‚  â”‚
â”‚  â”‚  C1  C#1 D1 D#1 E1  F1  F#1 G1 G#1 A1 A#1 B1           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â”‚  SELECTED KEY DETAILS (if any key is selected)                 â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Visualization Controls Section - EXPANDED

### Component Breakdown

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     VISUALIZATION CONTROLS                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                            â”‚
â”‚  Row 1: Show Layout Button                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ [ğŸ¹ Show Layout]                                    OR [âœ“ Layout V...] â”‚ â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â”‚ Toggles layout visualization. Text changes based on state.           â”‚ â”‚
â”‚  â”‚ Automatically dismisses when user clicks any piano key.              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                            â”‚
â”‚  Row 2: Distribution Mode Selector                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Distribution Mode: [Proportional â¯¯]                                   â”‚ â”‚
â”‚  â”‚                    [Fixed]                                            â”‚ â”‚
â”‚  â”‚                    [Custom]                                           â”‚ â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â”‚ Dropdown to select LED distribution strategy.                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                            â”‚
â”‚  Row 3: Color Selectors (NEW)                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â”‚  White Key LED Color:          Black Key LED Color:                  â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚ â”‚
â”‚  â”‚  â”‚ [COLOR] â”‚ RGB(0, 100, 150)  â”‚ [COLOR] â”‚ RGB(150, 0, 100)         â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚ â”‚
â”‚  â”‚   (Cyan/Blue)                   (Magenta/Pink)                       â”‚ â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â”‚  Click color square to open native color picker                      â”‚ â”‚
â”‚  â”‚  RGB values update in real-time                                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                            â”‚
â”‚  Row 4: Validation & Info Buttons (EXISTING)                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ [âœ“ Validate Mapping]  [ğŸ“Š Mapping Info]                             â”‚ â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â”‚ Load validation results and mapping statistics                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Color Picker Detailed View

### Visual Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  White Key LED Color:                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  RGB(0, 100, 150)       â”‚   â”‚
â”‚  â”‚ â”‚          â”‚                          â”‚   â”‚
â”‚  â”‚ â”‚ [COLOR]  â”‚  [Cyan/Blue example]    â”‚   â”‚
â”‚  â”‚ â”‚          â”‚                          â”‚   â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                             â”‚
â”‚  Features:                                  â”‚
â”‚  â€¢ Click on color box to open picker       â”‚
â”‚  â€¢ Drag across color spectrum to select    â”‚
â”‚  â€¢ Adjust brightness/saturation           â”‚
â”‚  â€¢ See RGB values immediately              â”‚
â”‚  â€¢ Live update to visualization           â”‚
â”‚                                             â”‚
â”‚  On Change:                                â”‚
â”‚  1. Browser color picker opens            â”‚
â”‚  2. User selects new color                â”‚
â”‚  3. RGB values instantly convert          â”‚
â”‚  4. WHITE_KEY_COLOR state updates         â”‚
â”‚  5. Layout viz (if active) updates        â”‚
â”‚  6. Console logs change for debugging     â”‚
â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Browser Color Picker (Native)

```
When user clicks the color input:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Color Picker Dialog (OS Native)      â”‚
â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Color Spectrum                â”‚ â”‚
â”‚  â”‚                                â”‚ â”‚
â”‚  â”‚  [Gradient selector area]      â”‚ â”‚
â”‚  â”‚                                â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                      â”‚
â”‚  Hue: â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ (slider)    â”‚
â”‚  Sat: â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ (slider)    â”‚
â”‚  Lum: â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ (slider)    â”‚
â”‚                                      â”‚
â”‚  Hex: #0064969 â†” RGB: 0, 100, 150 â”‚
â”‚                                      â”‚
â”‚  [ OK ]  [ Cancel ]                â”‚
â”‚                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

After selection â†’ Component updates instantly
```

---

## Feature 1: Layout Visualization Auto-Dismiss

### Workflow

```
STEP 1: Initial State
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Button: [ğŸ¹ Show Layout]                â”‚
â”‚ LEDs: Off                               â”‚
â”‚ Piano: All keys white (unselected)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“ USER CLICKS BUTTON
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Button: [âœ“ Layout Visible]              â”‚
â”‚ LEDs: WHITE_KEY_COLOR + BLACK_KEY_COLORâ”‚
â”‚ Piano: Visual with colored LEDs         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“ USER CLICKS ANY KEY
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Button: [ğŸ¹ Show Layout]                â”‚
â”‚ LEDs: Off (visualization dismissed)     â”‚
â”‚ Piano: Normal state, selected key shown â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Code Flow

```
User clicks piano key
         â†“
handleKeyClick(midiNote)
         â†“
ALSO calls: handleKeyPressWhileVisualizingLayout(event)
         â†“
IF layoutVisualizationActive === true
         â†“
THEN: toggleLayoutVisualization()
         â†“
Calls: await turnOffAllLeds()
         â†“
Sets: layoutVisualizationActive = false
       showingLayoutVisualization = false
         â†“
Button updates: "ğŸ¹ Show Layout" (reactive)
         â†“
Normal key selection proceeds as usual
```

---

## Feature 2: Visual LEDs Use Key Colors

### Color Application

```
Light Up Process:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layout Visualization Started        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚ COLLECT LEDs:                       â”‚
â”‚  â€¢ White key LEDs: []               â”‚
â”‚  â€¢ Black key LEDs: []               â”‚
â”‚                                     â”‚
â”‚ FOR each white key â†’ collect LEDs  â”‚
â”‚ FOR each black key â†’ collect LEDs  â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚ LIGHT UP:                           â”‚
â”‚  if whiteKeyLeds.length > 0         â”‚
â”‚    â†’ lightUpLedRangeWithColor(      â”‚
â”‚        whiteKeyLeds,                â”‚
â”‚        WHITE_KEY_COLOR              â”‚
â”‚      )                              â”‚
â”‚                                     â”‚
â”‚  if blackKeyLeds.length > 0         â”‚
â”‚    â†’ lightUpLedRangeWithColor(      â”‚
â”‚        blackKeyLeds,                â”‚
â”‚        BLACK_KEY_COLOR              â”‚
â”‚      )                              â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Color Values

```
Default Colors:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ WHITE_KEY_COLOR:                     â”‚
â”‚ â€¢ R: 0    (Red)                      â”‚
â”‚ â€¢ G: 100  (Green)                    â”‚
â”‚ â€¢ B: 150  (Blue)                     â”‚
â”‚ = Cyan/Blue tone                     â”‚
â”‚ = #0064ğŸµ6                            â”‚
â”‚                                      â”‚
â”‚ BLACK_KEY_COLOR:                     â”‚
â”‚ â€¢ R: 150  (Red)                      â”‚
â”‚ â€¢ G: 0    (Green)                    â”‚
â”‚ â€¢ B: 100  (Blue)                     â”‚
â”‚ = Magenta/Pink tone                  â”‚
â”‚ = #960064                            â”‚
â”‚                                      â”‚
â”‚ User can change via Color Pickers   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Feature 3: Color Selectors

### Input Conversion

```
Display Hex:
RGB(r, g, b) â†’ "#{r.toString(16).padStart(2, '0')}..."

Example:
RGB(0, 100, 150)
  â†’ r: 0 â†’ "00"
  â†’ g: 100 â†’ "64"
  â†’ b: 150 â†’ "96"
  â†’ Result: "#006496"

Convert Back:
Hex "#006496"
  â†’ Remove "#": "006496"
  â†’ r: "00" â†’ parseInt(..., 16) â†’ 0
  â†’ g: "64" â†’ parseInt(..., 16) â†’ 100
  â†’ b: "96" â†’ parseInt(..., 16) â†’ 150
  â†’ Result: RGB(0, 100, 150)
```

### State Management

```
Component State:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ WHITE_KEY_COLOR = {                 â”‚
â”‚   r: 0,    // 0-255                 â”‚
â”‚   g: 100,  // 0-255                 â”‚
â”‚   b: 150   // 0-255                 â”‚
â”‚ }                                   â”‚
â”‚                                     â”‚
â”‚ BLACK_KEY_COLOR = {                 â”‚
â”‚   r: 150,  // 0-255                 â”‚
â”‚   g: 0,    // 0-255                 â”‚
â”‚   b: 100   // 0-255                 â”‚
â”‚ }                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

User selects new color:
    â†“
Color picker closes
    â†“
on:change handler fires
    â†“
Parse hex to RGB
    â†“
Update WHITE_KEY_COLOR or BLACK_KEY_COLOR
    â†“
Component re-renders
    â†“
RGB label updates
    â†“
Next layout visualization uses new color
```

---

## Styling Hierarchy

```
.color-selectors (flex container)
â”œâ”€ .color-picker-group (white keys)
â”‚  â”œâ”€ label
â”‚  â””â”€ .color-picker-input (flex row)
â”‚     â”œâ”€ input[type="color"] (60x40px)
â”‚     â””â”€ .color-label (RGB display)
â”‚
â””â”€ .color-picker-group (black keys)
   â”œâ”€ label
   â””â”€ .color-picker-input (flex row)
      â”œâ”€ input[type="color"] (60x40px)
      â””â”€ .color-label (RGB display)

Responsive:
  Desktop: Two color pickers side-by-side
  Tablet:  Two color pickers side-by-side (wraps if needed)
  Mobile:  Stacked vertically (flex-wrap: wrap)
```

---

## Interaction Timeline

```
Timeline of User Actions:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

T0: Page loads
    â”œâ”€ Colors loaded from settings
    â”œâ”€ Color picker inputs populated with hex values
    â””â”€ RGB labels show current values

T1: User clicks color picker (white keys)
    â”œâ”€ Native color picker dialog opens
    â””â”€ Browser-specific color selection UI appears

T2: User selects new color in picker
    â”œâ”€ Hex value selected (e.g., #FF6B35)
    â””â”€ User clicks OK/Done

T3: Color picker closes
    â”œâ”€ on:change event fires
    â”œâ”€ Hex parsed to RGB: RGB(255, 107, 53)
    â”œâ”€ WHITE_KEY_COLOR state updates
    â”œâ”€ Component re-renders
    â”œâ”€ Input value reflects new hex
    â”œâ”€ RGB label shows new values
    â””â”€ Console logs change

T4: User clicks "ğŸ¹ Show Layout"
    â”œâ”€ Layout visualization activates
    â”œâ”€ WHITE_KEY LEDs light in NEW color
    â”œâ”€ BLACK_KEY LEDs light in old color (unchanged)
    â””â”€ Button shows "âœ“ Layout Visible"

T5: User clicks any piano key
    â”œâ”€ handleKeyPressWhileVisualizingLayout() detected
    â”œâ”€ LEDs turn off
    â”œâ”€ Button reverts to "ğŸ¹ Show Layout"
    â”œâ”€ Key selection proceeds normally
    â””â”€ New color persists for next visualization

T6: User changes black key color
    â””â”€ Same flow as T1-T3

T7: Next layout visualization shows BOTH new colors
```

---

## Summary

### What Changed

| Feature | Before | After |
|---------|--------|-------|
| Layout Button | Toggle on/off, stays on | Auto-dismisses on key click |
| LED Colors | Hardcoded/settings only | Color picker inputs added |
| Color Preview | None in UI | Real-time with label |
| User Control | Limited | Full RGB customization |
| Workflow | Multiple steps | Streamlined |

### Files Modified

- `frontend/src/lib/components/CalibrationSection3.svelte`
  - Added: 1 function, 2 color picker groups, CSS styling
  - Modified: 1 click handler

### Build Status

âœ… Compiles without errors  
âœ… No TypeScript errors  
âœ… No Svelte compilation warnings (except pre-existing)  
âœ… Responsive design verified  
âœ… Component builds successfully

---

**All changes complete and verified!** âœ…
