[Unit]
Description=Piano LED Visualizer Backend
After=network.target sound.target

[Service]
Type=simple
User=pi
WorkingDirectory=/home/pi/PianoLED-CoPilot/backend
Environment=PATH=/home/pi/PianoLED-CoPilot/backend/venv/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
Environment=VIRTUAL_ENV=/home/pi/PianoLED-CoPilot/backend/venv
EnvironmentFile=/home/pi/PianoLED-CoPilot/.env
ExecStart=/usr/bin/python3 /home/pi/PianoLED-CoPilot/backend/start.py
Restart=always
RestartSec=10

# Security hardening (relaxed for home directory access)
NoNewPrivileges=yes
PrivateTmp=yes
ProtectSystem=strict
ReadWritePaths=/home/pi/PianoLED-CoPilot

[Install]
WantedBy=multi-user.target